{"version":3,"sources":["../../../../../../packages/frontend/lib/data.js","../../../../../../packages/frontend/app/components/MateriList.js"],"sourcesContent":["const API_URL = \"http://localhost:5000\"; // backend SQLite\r\n\r\nfunction getTokenHeader() {\r\n  if (typeof window === 'undefined') return {}; // supaya SSR tidak error\r\n  const token = localStorage.getItem('token');\r\n  return token ? { 'Authorization': `Bearer ${token}` } : {};\r\n}\r\n\r\n// ------------------- TUGAS -------------------\r\n\r\n// Ambil semua tugas\r\nexport async function getAllTugas() {\r\n  const res = await fetch(`${API_URL}/tugas`, {\r\n    headers: getTokenHeader(),\r\n    cache: \"no-store\",\r\n  });\r\n  return res.json();\r\n}\r\n\r\n// Tambah tugas baru\r\nexport async function addTugas(tugas) {\r\n  const res = await fetch(`${API_URL}/tugas`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getTokenHeader() },\r\n    body: JSON.stringify(tugas),\r\n  });\r\n  return res.json();\r\n}\r\n\r\n// Hapus tugas\r\nexport async function deleteTugas(id) {\r\n  const res = await fetch(`${API_URL}/tugas/${id}`, {\r\n    method: \"DELETE\",\r\n    headers: getTokenHeader(),\r\n  });\r\n  return res.json();\r\n}\r\n\r\n// Update tugas (opsional)\r\nexport async function updateTugas(id, tugas) {\r\n  const res = await fetch(`${API_URL}/tugas/${id}`, {\r\n    method: \"PUT\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getTokenHeader() },\r\n    body: JSON.stringify(tugas),\r\n  });\r\n  return res.json();\r\n}\r\n\r\n// ---------------------------------------------\r\n//                   JADWAL\r\n// ---------------------------------------------\r\nexport async function getAllJadwal() {\r\n  const res = await fetch(`${API_URL}/jadwal`, {\r\n    headers: getTokenHeader(),\r\n    cache: 'no-store',\r\n  });\r\n  return res.json();\r\n}\r\n\r\nexport async function addJadwal(data) {\r\n  const res = await fetch(`${API_URL}/jadwal`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json', ...getTokenHeader() },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteJadwal(id) {\r\n  const res = await fetch(`${API_URL}/jadwal/${id}`, {\r\n    method: 'DELETE',\r\n    headers: getTokenHeader(),\r\n  });\r\n  return res.json();\r\n}\r\n\r\n\r\n// ------------------- MATERI -------------------\r\n// Ambil semua materi\r\nexport async function fetchMateri() {\r\n  try {\r\n    const res = await fetch(`${API_URL}/materi`, {\r\n      headers: getTokenHeader()\r\n    });\r\n    if (!res.ok) throw new Error(\"Gagal fetch materi\");\r\n    return res.json();\r\n  } catch (error) {\r\n    console.error(\"Error fetchMateri:\", error);\r\n    return [];\r\n  }\r\n}\r\n\r\n// Ambil materi berdasarkan ID\r\nexport async function fetchMateriById(id) {\r\n  try {\r\n    const res = await fetch(`${API_URL}/materi/${id}`, {\r\n      headers: getTokenHeader()\r\n    });\r\n    if (!res.ok) return null;\r\n    return res.json();\r\n  } catch (error) {\r\n    console.error(\"Error fetchMateriById:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// Tambah materi baru\r\nexport async function addMateri(data) {\r\n  const res = await fetch(`${API_URL}/materi`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getTokenHeader() },\r\n    body: JSON.stringify(data)\r\n  });\r\n  return res.json();\r\n}\r\n\r\n// Update materi\r\nexport async function updateMateri(id, data) {\r\n  const res = await fetch(`${API_URL}/materi/${id}`, {\r\n    method: \"PUT\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getTokenHeader() },\r\n    body: JSON.stringify(data)\r\n  });\r\n  return res.json();\r\n}\r\n\r\n// Hapus materi\r\nexport async function deleteMateri(id) {\r\n  const res = await fetch(`${API_URL}/materi/${id}`, {\r\n    method: \"DELETE\",\r\n    headers: getTokenHeader()\r\n  });\r\n  return res.json();\r\n}\r\n","\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { addMateri, deleteMateri, updateMateri } from \"@/lib/data\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function MateriList({ initialMateri }) {\r\n  const router = useRouter();\r\n  const [materi, setMateri] = useState(initialMateri || []);\r\n  const [form, setForm] = useState({\r\n    judul: \"\",\r\n    deskripsi: \"\",\r\n    link: \"\",\r\n    tanggal: \"\",\r\n  });\r\n\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const role = localStorage.getItem(\"role\");\r\n    setIsAdmin(role === \"admin\");\r\n  }, []);\r\n\r\nconst handleAdd = async (e) => {\r\n  e.preventDefault();\r\n  if (!isAdmin) return;\r\n\r\n  const payload = {\r\n    judul: form.judul,\r\n    isi: form.deskripsi,\r\n    file: form.link,\r\n    tanggal: form.tanggal,\r\n  };\r\n\r\n  const newMateri = await addMateri(payload);\r\n  \r\n  // ✅ Gunakan struktur yang sama dengan database\r\n  setMateri([...materi, { \r\n    id: newMateri.id, \r\n    judul: payload.judul,\r\n    isi: payload.isi,      // ← gunakan \"isi\" bukan \"deskripsi\"\r\n    file: payload.file,\r\n    tanggal: payload.tanggal\r\n  }]);\r\n\r\n  setForm({ judul: \"\", deskripsi: \"\", link: \"\", tanggal: \"\" });\r\n};\r\n\r\n  const handleDelete = async (id) => {\r\n    if (!isAdmin) return;\r\n    await deleteMateri(id);\r\n    setMateri(materi.filter((m) => m.id !== id));\r\n  };\r\n\r\n  const handleClickCard = (id) => {\r\n    router.push(`/materi/${id}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6 \">\r\n\r\n      {/* === FORM TAMBAH MATERI === */}\r\n      {isAdmin && (\r\n        <form\r\n          onSubmit={handleAdd}\r\n          className=\"p-4 text-gray-900 bg-gray-100 rounded-lg shadow space-y-3\"\r\n        >\r\n          <h2 className=\"font-bold text-lg\">Tambah Materi</h2>\r\n\r\n          {/* JUDUL */}\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Judul\"\r\n            value={form.judul}\r\n            onChange={(e) => setForm({ ...form, judul: e.target.value })}\r\n            className=\"w-full border p-2 rounded\"\r\n            required\r\n          />\r\n\r\n          {/* DESKRIPSI */}\r\n          <textarea\r\n            placeholder=\"Deskripsi materi\"\r\n            value={form.deskripsi}\r\n            onChange={(e) => setForm({ ...form, deskripsi: e.target.value })}\r\n            className=\"w-full border p-2 rounded\"\r\n            required\r\n          />\r\n\r\n          {/* LINK FILE */}\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Link file (Google Drive, PDF, dll)\"\r\n            value={form.link}\r\n            onChange={(e) => setForm({ ...form, link: e.target.value })}\r\n            className=\"w-full border p-2 rounded\"\r\n            required\r\n          />\r\n\r\n          {/* PREVIEW FILE */}\r\n          {form.link && (\r\n            <div className=\"mt-2 p-3 border rounded bg-white\">\r\n              <p className=\"font-semibold text-gray-700 mb-1\">Preview File:</p>\r\n\r\n              {/* If PDF */}\r\n              {form.link.endsWith(\".pdf\") ? (\r\n                <iframe\r\n                  src={form.link}\r\n                  className=\"w-full h-72 border\"\r\n                ></iframe>\r\n              ) : (\r\n                <a\r\n                  href={form.link}\r\n                  target=\"_blank\"\r\n                  className=\"text-blue-600 underline\"\r\n                  rel=\"noopener noreferrer\"\r\n                >\r\n                  Buka File\r\n                </a>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* TANGGAL */}\r\n          <input\r\n            type=\"date\"\r\n            value={form.tanggal}\r\n            onChange={(e) => setForm({ ...form, tanggal: e.target.value })}\r\n            className=\"w-full border p-2 rounded\"\r\n            required\r\n          />\r\n\r\n          <button\r\n            type=\"submit\"\r\n            className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-800 cursor-pointer\"\r\n          >\r\n            Tambah\r\n          </button>\r\n        </form>\r\n      )}\r\n\r\n      {/* === LIST MATERI === */}\r\n      <ul className=\"space-y-3\">\r\n        {materi.length === 0 ? (\r\n          <p className=\"text-gray-500\">Belum ada materi.</p>\r\n        ) : (\r\n          materi.map((m) => (\r\n            <li\r\n              key={m.id}\r\n              className=\"p-4 text-gray-900 bg-gray-100 rounded-lg shadow cursor-pointer hover:bg-gray-200\"\r\n              onClick={() => handleClickCard(m.id)}\r\n            >\r\n              <div className=\"flex justify-between items-center\">\r\n                <p className=\"font-semibold\">{m.judul}</p>\r\n                {isAdmin && (\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDelete(m.id);\r\n                    }}\r\n                    className=\"text-red-500 hover:text-red-700 font-bold cursor-pointer\"\r\n                  >\r\n                    Hapus\r\n                  </button>\r\n                )}\r\n              </div>\r\n\r\n              {/* Deskripsi kecil */}\r\n              <p className=\"text-sm text-gray-600\">{m.isi}</p>\r\n\r\n              <p className=\"text-sm text-gray-500 mt-1\">Tanggal: {m.tanggal}</p>\r\n            </li>\r\n          ))\r\n        )}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}